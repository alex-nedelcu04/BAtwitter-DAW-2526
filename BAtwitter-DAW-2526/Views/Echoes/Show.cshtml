@model BAtwitter_DAW_2526.Models.Echo

<!-- Aici vom insera recursia pt. parintii postarii -->

@* Echo + comments*@
@if(ViewBag.Message != null)
{
    <h2 class="p-3 rounded-3 text-center mb-5 alert @ViewBag.Type">@ViewBag.Message</h2>
}

<div class="card">

    <partial name="EchoInfo" model="Model" />

    @if (Model.UserId == ViewBag.CurrentUser)
    {
        <div class="d-flex flex-row justify-content-between">

            <a class="btn btn-success" asp-controller="Echoes" asp-action="Edit" asp-route-id="@Model.Id">Modify Echo</a>

            <form method="post" asp-controller="Echoes" asp-action="Delete" asp-route-id="@Model.Id">

                <button class="btn btn-danger" type="submit">Delete Echo</button>

            </form>

        </div>
    }

</div>

<br />
<br />

@* Afisare comentarii recursive - afisate exact ca postarile *@

@if (Model.Comments != null && Model.Comments.Any())
{
    <h5 class="mt-4 mb-3">Comments:</h5>
    @foreach (var comm in Model.Comments.OrderBy(c => c.DateCreated))
    {
        <partial name="CommentRecursion" model="@comm" />
    }
}


@* Afisarea formularului in care se poate adauga un comentariu *@

<div class="container">

    <div class="row">

        <div class="col-md-2"></div>

        <div class="col-md-8">

            <div class="card">

                <form method="post" asp-controller="Echoes" asp-action="Show">

                    <div class="card-body">

                        <input type="hidden" name="EchoId" value="@Model.Id" />

                        <label>Comment content</label>
                        <br />

                        <textarea class="form-control" name="Content"></textarea>
                        <span asp-validation-for="Content" class="text-danger"></span>
                        <br /><br/>

                        <button class="btn btn-success" type="submit">Add Comment</button>

                    </div>

                </form>

            </div>

        </div>

        <div class="col-md-2"></div>

    </div>

</div>